Attribute VB_Name = "GitHubTool_Import"

Sub ImportVBAFilesFromGitHub()
    Dim fso As Object
    Dim folder As Object
    Dim file As Object
    Dim fileName As String
    Dim moduleName As String
    Dim vbProject As Object
    Dim vbComp As Object
    Dim filePath As String
    Dim extName As String
    
    'folder containing VBA files from GitHub zip file
    filePath = "C:\Users\Alyssa Vu\Downloads\thermquik-ribbon-main\thermquik-ribbon-main\"
    
    Set fso = CreateObject("Scripting.FileSystemObject")
    Set folder = fso.GetFolder(filePath)
    Set vbProject = ThisWorkbook.vbProject

    For Each file In folder.Files
        
        extName = Split(file.Name, ".")(1)
        moduleName = Split(file.Name, ".")(0)
        
        'import valid file
        If extName = "bas" Or extName = "frx" Or extName = "frm" Then
            
            On Error Resume Next
            Set vbComp = vbProject.VBComponents(moduleName)
            On Error GoTo 0
            
            ' If the module exists, remove it
            If Not vbComp Is Nothing Then
                vbProject.VBComponents.Remove vbComp
                Set vbComp = Nothing
            End If
            
            vbProject.VBComponents.Import file.Path
        End If
        
        'hardcode to import ThisWorkbook
        If extName = "cls" And moduleName = "ThisWorkbook" Then
            
            vbProject.VBComponents("ThisWorkbook").CodeModule.DeleteLines 1, vbProject.VBComponents("ThisWorkbook").CodeModule.CountOfLines
            vbProject.VBComponents("ThisWorkbook").CodeModule.AddFromFile file
            vbProject.VBComponents("ThisWorkbook").CodeModule.DeleteLines 1, 5
            
        End If
        
    Next file
    
    MsgBox "VBA files imported!"
    
End Sub



